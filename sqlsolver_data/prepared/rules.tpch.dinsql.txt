select l_returnflag, l_linestatus, sum(l_quantity) as sum_qty, sum(l_extendedprice) as sum_base_price, sum(l_extendedprice * (1 - l_discount)) as sum_disc_price, sum(l_extendedprice * (1 - l_discount) * (1 + l_tax)) as sum_charge, avg(l_quantity) as avg_qty, avg(l_extendedprice) as avg_price, avg(l_discount) as avg_disc, count(*) as count_order from lineitem where l_shipdate <= date('1998-12-01', '-90 day') group by l_returnflag, l_linestatus order by l_returnflag, l_linestatus
SELECT l_returnflag, l_linestatus, COUNT(*), SUM(l_quantity), SUM(l_extendedprice), SUM(l_extendedprice*(1-l_discount)), SUM(l_extendedprice*(1-l_discount)*(1+l_tax)), AVG(l_quantity), AVG(l_extendedprice), AVG(l_discount) FROM lineitem WHERE l_shipdate < DATE('1998-12-01', '-90 days') GROUP BY l_returnflag, l_linestatus ORDER BY l_returnflag ASC, l_linestatus ASC
select s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment from part, supplier, partsupp, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and p_size = 15 and p_type like '%BRASS' and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE' and ps_supplycost = (select min(ps_supplycost) from partsupp, supplier, nation, region where p_partkey = ps_partkey and s_suppkey = ps_suppkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'EUROPE') order by s_acctbal desc, n_name, s_name, p_partkey limit 100
SELECT T1.s_acctbal, T2.s_name, T3.n_name, T4.p_partkey, T4.p_name, T4.p_mfgr, T1.s_address, T1.s_phone, T1.s_comment  FROM supplier AS T1  JOIN nation AS T3 ON T1.s_nationkey = T3.n_nationkey  JOIN region AS T5 ON T3.n_regionkey = T5.r_regionkey  JOIN partsupp AS T6 ON T1.s_suppkey = T6.ps_suppkey  JOIN part AS T4 ON T6.ps_partkey = T4.p_partkey  WHERE T4.p_type LIKE '%BRASS'  AND T4.p_size = 15  AND T3.n_name = 'EUROPE'  AND T6.ps_supplycost = (SELECT MIN(ps_supplycost) FROM partsupp WHERE ps_partkey = T4.p_partkey AND ps_suppkey IN (SELECT s_suppkey FROM supplier WHERE s_nationkey IN (SELECT n_nationkey FROM nation WHERE n_name = 'EUROPE')) )  ORDER BY T3.n_name, T2.s_name, T4.p_partkey  LIMIT 100
select l_orderkey, sum(l_extendedprice * (1 - l_discount)) as revenue, o_orderdate, o_shippriority from customer, orders, lineitem where c_mktsegment = 'BUILDING' and c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate < date('1995-03-15') and l_shipdate > date('1995-03-15') group by l_orderkey, o_orderdate, o_shippriority order by revenue desc, o_orderdate limit 10
SELECT l_orderkey, o_orderdate, o_shippriority, SUM(l_extendedprice * (1 - l_discount)) AS potential_revenue FROM lineitem JOIN orders ON lineitem.l_orderkey = orders.o_orderkey JOIN customer ON orders.o_custkey = customer.c_custkey WHERE o_orderdate < '1995-03-15' AND l_shipdate > '1995-03-15' AND c_mktsegment = 'BUILDING' GROUP BY l_orderkey, o_orderdate, o_shippriority ORDER BY potential_revenue DESC, o_orderdate DESC LIMIT 10
select o_orderpriority, count(*) as order_count from orders where o_orderdate >= date('1993-07-01') and o_orderdate < date('1993-07-01', '+3 month') and exists (select * from lineitem where l_orderkey = o_orderkey and l_commitdate < l_receiptdate) group by o_orderpriority order by o_orderpriority
SELECT T1.o_orderpriority, COUNT(DISTINCT T1.o_orderkey)  FROM orders AS T1  JOIN lineitem AS T2 ON T1.o_orderkey = T2.l_orderkey  WHERE T1.o_orderdate >= '1993-07-01' AND T1.o_orderdate < '1993-10-01' AND T2.l_receiptdate > T2.l_commitdate  GROUP BY T1.o_orderpriority  ORDER BY T1.o_orderpriority ASC
select n_name, sum(l_extendedprice * (1 - l_discount)) as revenue from customer, orders, lineitem, supplier, nation, region where c_custkey = o_custkey and l_orderkey = o_orderkey and l_suppkey = s_suppkey and c_nationkey = s_nationkey and s_nationkey = n_nationkey and n_regionkey = r_regionkey and r_name = 'ASIA' and o_orderdate >= date('1994-01-01') and o_orderdate < date('1994-01-01', '+1 year') group by n_name order by revenue desc
SELECT n.n_name AS nation, SUM(l.l_extendedprice * (1 - l.l_discount)) AS revenue_volume FROM lineitem l JOIN orders o ON l.l_orderkey = o.o_orderkey JOIN customer c ON o.o_custkey = c.c_custkey JOIN supplier s ON l.l_suppkey = s.s_suppkey JOIN nation n ON c.c_nationkey = n.n_nationkey AND s.s_nationkey = n.n_nationkey WHERE n.n_regionkey = ( SELECT r.r_regionkey FROM region r WHERE r.r_name = 'ASIA' ) AND l.l_shipdate BETWEEN '1994-01-01' AND '1994-12-31' GROUP BY n.n_name ORDER BY revenue_volume DESC
select sum(l_extendedprice * l_discount) as revenue from lineitem where l_shipdate >= date('1994-01-01') and l_shipdate < date('1994-01-01', '+1 year') and l_discount between 0.05 and 0.07 and l_quantity < 24
SELECT SUM(l_extendedprice * l_discount) AS potential_revenue_increase FROM lineitem JOIN orders ON lineitem.l_orderkey = orders.o_orderkey WHERE l_shipdate >= '1994-01-01' AND l_shipdate < '1995-01-01' AND l_discount >= 0.05 AND l_discount <= 0.07 AND l_quantity < 24
select supp_nation, cust_nation, l_year, sum(volume) as revenue from (select n1.n_name as supp_nation, n2.n_name as cust_nation, strftime('%Y', l_shipdate) as l_year, l_extendedprice * (1 - l_discount) as volume from supplier, lineitem, orders, customer, nation n1, nation n2 where s_suppkey = l_suppkey and o_orderkey = l_orderkey and c_custkey = o_custkey and s_nationkey = n1.n_nationkey and c_nationkey = n2.n_nationkey and ((n1.n_name = 'FRANCE' and n2.n_name = 'GERMANY') or (n1.n_name = 'GERMANY' and n2.n_name = 'FRANCE')) and l_shipdate between '1995-01-01' and '1996-12-31') as shipping group by supp_nation, cust_nation, l_year order by supp_nation, cust_nation, l_year
SELECT nation.n_name AS supplier_nation, nation_1.n_name AS customer_nation, strftime('%Y', lineitem.l_shipdate) AS l_year, SUM(lineitem.l_extendedprice * (1 - lineitem.l_discount)) AS revenue  FROM supplier  JOIN nation ON supplier.s_nationkey = nation.n_nationkey  JOIN lineitem ON lineitem.l_suppkey = supplier.s_suppkey  JOIN orders ON lineitem.l_orderkey = orders.o_orderkey  JOIN customer ON orders.o_custkey = customer.c_custkey  JOIN nation AS nation_1 ON customer.c_nationkey = nation_1.n_nationkey  WHERE (nation.n_name = 'FRANCE' AND nation_1.n_name = 'GERMANY') OR (nation.n_name = 'GERMANY' AND nation_1.n_name = 'FRANCE')  AND lineitem.l_shipdate >= '1995-01-01' AND lineitem.l_shipdate < '1997-01-01'  GROUP BY nation.n_name, nation_1.n_name, strftime('%Y', lineitem.l_shipdate)  ORDER BY supplier_nation, customer_nation, l_year
select o_year, sum(case when nation = 'BRAZIL' then volume else 0 end) / sum(volume) as mkt_share from (select strftime('%Y', o_orderdate) as o_year, l_extendedprice * (1 - l_discount) as volume, n2.n_name as nation from part, supplier, lineitem, orders, customer, nation n1, nation n2, region where p_partkey = l_partkey and s_suppkey = l_suppkey and l_orderkey = o_orderkey and o_custkey = c_custkey and c_nationkey = n1.n_nationkey and n1.n_regionkey = r_regionkey and r_name = 'AMERICA' and s_nationkey = n2.n_nationkey and o_orderdate between '1995-01-01' and '1996-12-31' and p_type = 'ECONOMY ANODIZED STEEL') as all_nations group by o_year order by o_year
SELECT orders.o_orderdate,         SUM(lineitem.l_extendedprice * (1-lineitem.l_discount)) /         (SELECT SUM(lineitem.l_extendedprice * (1-lineitem.l_discount))          FROM lineitem          JOIN orders ON lineitem.l_orderkey = orders.o_orderkey          JOIN customer ON orders.o_custkey = customer.c_custkey          JOIN nation ON customer.c_nationkey = nation.n_nationkey          JOIN supplier ON lineitem.l_suppkey = supplier.s_suppkey          JOIN part ON lineitem.l_partkey = part.p_partkey          JOIN region ON nation.n_regionkey = region.r_regionkey          WHERE nation.n_name = 'BRAZIL'          AND region.r_name = 'AMERICA'          AND part.p_type = 'ECONOMY ANODIZED STEEL'          AND orders.o_orderdate BETWEEN '1995-01-01' AND '1996-12-31')  FROM lineitem  JOIN orders ON lineitem.l_orderkey = orders.o_orderkey  JOIN customer ON orders.o_custkey = customer.c_custkey  JOIN nation ON customer.c_nationkey = nation.n_nationkey  JOIN supplier ON lineitem.l_suppkey = supplier.s_suppkey  JOIN part ON lineitem.l_partkey = part.p_partkey  JOIN region ON nation.n_regionkey = region.r_regionkey  WHERE nation.n_name = 'BRAZIL'  AND region.r_name = 'AMERICA'  AND part.p_type = 'ECONOMY ANODIZED STEEL'  AND orders.o_orderdate BETWEEN '1995-01-01' AND '1996-12-31'  GROUP BY strftime('%Y', orders.o_orderdate)  ORDER BY strftime('%Y', orders.o_orderdate) ASC
select nation, o_year, sum(amount) as sum_profit from (select n_name as nation, strftime('%Y', o_orderdate) as o_year, l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount from part, supplier, lineitem, partsupp, orders, nation where s_suppkey = l_suppkey and ps_suppkey = l_suppkey and ps_partkey = l_partkey and p_partkey = l_partkey and o_orderkey = l_orderkey and s_nationkey = n_nationkey and p_name like '%green%') as profit group by nation, o_year order by nation, o_year desc
SELECT n.n_name AS nation, strftime('%Y', o.o_orderdate) AS o_year, SUM((l.l_extendedprice * (1 - l.l_discount)) - (ps.ps_supplycost * l.l_quantity)) AS profit FROM lineitem l JOIN orders o ON l.l_orderkey = o.o_orderkey JOIN partsupp ps ON l.l_partkey = ps.ps_partkey AND l.l_suppkey = ps.ps_suppkey JOIN part p ON l.l_partkey = p.p_partkey JOIN supplier s ON ps.ps_suppkey = s.s_suppkey JOIN nation n ON s.s_nationkey = n.n_nationkey WHERE p.p_name LIKE '%green%' GROUP BY n.n_name, strftime('%Y', o.o_orderdate) ORDER BY n.n_name ASC, o_year DESC
select c_custkey, c_name, sum(l_extendedprice * (1 - l_discount)) as revenue, c_acctbal, n_name, c_address, c_phone, c_comment from customer, orders, lineitem, nation where c_custkey = o_custkey and l_orderkey = o_orderkey and o_orderdate >= date('1993-10-01') and o_orderdate < date('1993-10-01', '+3 month') and l_returnflag = 'R' and c_nationkey = n_nationkey group by c_custkey, c_name, c_acctbal, c_phone, n_name, c_address, c_comment order by revenue desc limit 20
SELECT customer.c_custkey, customer.c_name, customer.c_address, customer.c_nationkey, customer.c_phone, customer.c_acctbal, customer.c_comment, SUM(lineitem.l_extendedprice*(1-lineitem.l_discount)) AS revenue_lost  FROM customer  JOIN orders ON customer.c_custkey = orders.o_custkey  JOIN lineitem ON orders.o_orderkey = lineitem.l_orderkey  WHERE lineitem.l_shipdate >= '1993-10-01' AND lineitem.l_shipdate < '1994-01-01' AND lineitem.l_returnflag = 'R'  GROUP BY customer.c_custkey  ORDER BY revenue_lost DESC  LIMIT 20
select ps_partkey, sum(ps_supplycost * ps_availqty) as ps_value from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'GERMANY' group by ps_partkey having sum(ps_supplycost * ps_availqty) > (select sum(ps_supplycost * ps_availqty) * 0.0001 from partsupp, supplier, nation where ps_suppkey = s_suppkey and s_nationkey = n_nationkey and n_name = 'GERMANY') order by ps_value desc
SELECT T1.p_partkey, SUM(T3.ps_supplycost * T3.ps_availqty) AS ps_value  FROM part AS T1  JOIN partsupp AS T3 ON T1.p_partkey = T3.ps_partkey  JOIN supplier AS T2 ON T3.ps_suppkey = T2.s_suppkey  JOIN nation AS T4 ON T2.s_nationkey = T4.n_nationkey  WHERE T4.n_name = 'GERMANY'  GROUP BY T1.p_partkey  HAVING SUM(T3.ps_supplycost * T3.ps_availqty) > (SELECT SUM(T5.ps_supplycost * T5.ps_availqty) / 10000 FROM part AS T5 JOIN partsupp AS T7 ON T5.p_partkey = T7.ps_partkey JOIN supplier AS T6 ON T7.ps_suppkey = T6.s_suppkey JOIN nation AS T8 ON T6.s_nationkey = T8.n_nationkey WHERE T8.n_name = 'GERMANY') ORDER BY ps_value DESC
select l_shipmode, sum(case when o_orderpriority = '1-URGENT' or o_orderpriority = '2-HIGH' then 1 else 0 end) as high_line_count, sum(case when o_orderpriority <> '1-URGENT' and o_orderpriority <> '2-HIGH' then 1 else 0 end) as low_line_count from orders, lineitem where o_orderkey = l_orderkey and l_shipmode in ('MAIL', 'SHIP') and l_commitdate < l_receiptdate and l_shipdate < l_commitdate and l_receiptdate >= date('1994-01-01') and l_receiptdate < date('1994-01-01', '+1 year') group by l_shipmode order by l_shipmode
SELECT lineitem.l_shipmode, COUNT(DISTINCT CASE WHEN lineitem.l_shipdate < lineitem.l_commitdate AND lineitem.l_receiptdate > lineitem.l_commitdate AND lineitem.l_orderkey IN (SELECT o_orderkey FROM orders WHERE strftime('%Y', o_orderdate) = '1994') THEN lineitem.l_orderkey END) AS late_lineitems, COUNT(DISTINCT CASE WHEN lineitem.l_shipdate < lineitem.l_commitdate AND lineitem.l_receiptdate > lineitem.l_commitdate AND lineitem.l_orderkey IN (SELECT o_orderkey FROM orders WHERE strftime('%Y', o_orderdate) = '1994') AND orders.o_orderpriority IN ('1-URGENT', '2-HIGH') THEN lineitem.l_orderkey END) AS late_lineitems_priority_1_2, COUNT(DISTINCT CASE WHEN lineitem.l_shipdate < lineitem.l_commitdate AND lineitem.l_receiptdate > lineitem.l_commitdate AND lineitem.l_orderkey IN (SELECT o_orderkey FROM orders WHERE strftime('%Y', o_orderdate) = '1994') AND orders.o_orderpriority NOT IN ('1-URGENT', '2-HIGH') THEN lineitem.l_orderkey END) AS late_lineitems_other_priority FROM lineitem JOIN orders ON lineitem.l_orderkey = orders.o_orderkey WHERE lineitem.l_receiptdate > lineitem.l_commitdate GROUP BY lineitem.l_shipmode ORDER BY lineitem.l_shipmode ASC
select c_count, count(*) as custdist from (select c_custkey, count(o_orderkey) as c_count from customer left outer join orders on c_custkey = o_custkey and o_comment not like '%special%requests%' group by c_custkey) as c_orders group by c_count order by custdist desc, c_count desc
SELECT COUNT(*)  FROM customer  LEFT JOIN orders ON customer.c_custkey = orders.o_custkey  WHERE orders.o_comment NOT LIKE '%special%requests%'  GROUP BY customer.c_custkey
select 100.00 * sum(case when p_type like 'PROMO%' then l_extendedprice * (1 - l_discount) else 0 end) / sum(l_extendedprice * (1 - l_discount)) as promo_revenue from lineitem, part where l_partkey = p_partkey and l_shipdate >= date('1995-09-01') and l_shipdate < date('1995-09-01', '+1 month')
SELECT (SUM(l_extendedprice * (1 - l_discount)) / SUM(l_extendedprice * (1 - l_discount))) * 100  FROM lineitem  JOIN part ON lineitem.l_partkey = part.p_partkey  WHERE strftime('%Y', l_shipdate) = '1995' AND strftime('%m', l_shipdate) = '09' AND p_type LIKE 'PROMO%'
select s_suppkey, s_name, s_address, s_phone, total_revenue from supplier, (select l_suppkey as supplier_no, sum(l_extendedprice * (1 - l_discount)) as total_revenue from lineitem where l_shipdate >= date('1996-01-01') and l_shipdate < date('1996-01-01', '+3 month') group by l_suppkey) as revenue where s_suppkey = revenue.supplier_no and total_revenue = (select max(total_revenue) from (select l_suppkey as supplier_no, sum(l_extendedprice * (1 - l_discount)) as total_revenue from lineitem where l_shipdate >= date('1996-01-01') and l_shipdate < date('1996-01-01', '+3 month') group by l_suppkey) as revenue) order by s_suppkey
SELECT T1.s_suppkey, T1.s_name, T1.s_address, T1.s_phone, SUM(T2.l_extendedprice * (1 - T2.l_discount)) AS total_revenue  FROM supplier AS T1  JOIN lineitem AS T2 ON T2.l_suppkey = T1.s_suppkey  WHERE strftime('%Y', T2.l_shipdate) = '1996' AND strftime('%m', T2.l_shipdate) BETWEEN '01' AND '03'  GROUP BY T1.s_suppkey, T1.s_name, T1.s_address, T1.s_phone  HAVING SUM(T2.l_extendedprice * (1 - T2.l_discount)) = (SELECT MAX(total_revenue) FROM (SELECT SUM(T3.l_extendedprice * (1 - T3.l_discount)) AS total_revenue FROM supplier AS T4 JOIN lineitem AS T3 ON T3.l_suppkey = T4.s_suppkey WHERE strftime('%Y', T3.l_shipdate) = '1996' AND strftime('%m', T3.l_shipdate) BETWEEN '01' AND '03' GROUP BY T4.s_suppkey) )  ORDER BY T1.s_suppkey
select p_brand, p_type, p_size, count(distinct ps_suppkey) as supplier_cnt from partsupp, part where p_partkey = ps_partkey and p_brand <> 'Brand#45' and p_type not like 'MEDIUM POLISHED%' and p_size in (49, 14, 23, 45, 19, 3, 36, 9) and ps_suppkey not in (select s_suppkey from supplier where s_comment like '%Customer%Complaints%') group by p_brand, p_type, p_size order by supplier_cnt desc, p_brand, p_type, p_size
SELECT part.p_brand, part.p_type, part.p_size, COUNT(DISTINCT supplier.s_suppkey) AS supplier_count  FROM supplier  JOIN partsupp ON supplier.s_suppkey = partsupp.ps_suppkey  JOIN part ON partsupp.ps_partkey = part.p_partkey  JOIN lineitem ON part.p_partkey = lineitem.l_partkey  JOIN orders ON lineitem.l_orderkey = orders.o_orderkey  JOIN customer ON orders.o_custkey = customer.c_custkey  JOIN nation ON supplier.s_nationkey = nation.n_nationkey  JOIN region ON nation.n_regionkey = region.r_regionkey  WHERE part.p_size IN (49, 14, 23, 45, 19, 3, 36, 9)  AND part.p_type NOT LIKE 'MEDIUM POLISHED%'  AND part.p_brand <> 'Brand#45'  AND supplier.s_comment NOT LIKE '%Customer%Complaints%'  GROUP BY part.p_brand, part.p_type, part.p_size  ORDER BY supplier_count DESC, part.p_brand ASC, part.p_type ASC, part.p_size ASC
select sum(l_extendedprice) / 7.0 as avg_yearly from lineitem, part where p_partkey = l_partkey and p_brand = 'Brand#23' and p_container = 'MED BOX' and l_quantity < (select 0.2 * avg(l_quantity) from lineitem where l_partkey = p_partkey)
SELECT AVG(l_extendedprice) - (AVG(l_extendedprice) * 0.2) AS average_yearly_gross_loss FROM lineitem  JOIN part ON lineitem.l_partkey = part.p_partkey  WHERE p_brand = 'Brand#23'  AND p_container = 'MED BOX'
select c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, sum(l_quantity) from customer, orders, lineitem where o_orderkey in (select l_orderkey from lineitem group by l_orderkey having sum(l_quantity) > 300) and c_custkey = o_custkey and o_orderkey = l_orderkey group by c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice order by o_totalprice desc, o_orderdate limit 100
SELECT c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice, sum(l_quantity)  FROM customer  JOIN orders ON customer.c_custkey = orders.o_custkey  JOIN lineitem ON orders.o_orderkey = lineitem.l_orderkey  GROUP BY c_name, c_custkey, o_orderkey, o_orderdate, o_totalprice  HAVING sum(l_quantity) > 300  ORDER BY o_totalprice DESC, o_orderdate ASC  LIMIT 100
select sum(l_extendedprice * (1 - l_discount)) as revenue from lineitem, part where (p_partkey = l_partkey and p_brand = 'Brand#12' and p_container in ('SM CASE', 'SM BOX', 'SM PACK', 'SM PKG') and l_quantity >= 1 and l_quantity <= 11 and p_size between 1 and 5 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON') or (p_partkey = l_partkey and p_brand = 'Brand#23' and p_container in ('MED BAG', 'MED BOX', 'MED PKG', 'MED PACK') and l_quantity >= 10 and l_quantity <= 20 and p_size between 1 and 10 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON') or (p_partkey = l_partkey and p_brand = 'Brand#34' and p_container in ('LG CASE', 'LG BOX', 'LG PACK', 'LG PKG') and l_quantity >= 20 and l_quantity <= 30 and p_size between 1 and 15 and l_shipmode in ('AIR', 'AIR REG') and l_shipinstruct = 'DELIVER IN PERSON')
SELECT sum(l_extendedprice * (1 - l_discount))  FROM lineitem AS T1  JOIN part AS T2 ON T1.l_partkey = T2.p_partkey  JOIN partsupp AS T3 ON T1.l_suppkey = T3.ps_suppkey AND T1.l_partkey = T3.ps_partkey  JOIN orders AS T4 ON T1.l_orderkey = T4.o_orderkey  JOIN customer AS T5 ON T4.o_custkey = T5.c_custkey  JOIN nation AS T6 ON T5.c_nationkey = T6.n_nationkey  JOIN supplier AS T7 ON T3.ps_suppkey = T7.s_suppkey AND T6.n_nationkey = T7.s_nationkey  JOIN region AS T8 ON T6.n_regionkey = T8.r_regionkey  WHERE T2.p_brand IN ('Brand#12','Brand#23','Brand#34')  AND T1.l_shipmode = 'AIR'  AND T4.o_orderstatus = 'F'  AND (     (T1.l_quantity BETWEEN 1 AND 11 AND T2.p_container IN ('SM CASE','SM BOX','SM PACK','SM PKG') AND T2.p_size BETWEEN 1 AND 5) OR (T1.l_quantity BETWEEN 10 AND 20 AND T2.p_container IN ('MED BAG','MED BOX','MED PKG','MED PACK') AND T2.p_size BETWEEN 1 AND 10) OR (T1.l_quantity BETWEEN 20 AND 30 AND T2.p_container IN ('LG CASE','LG BOX','LG PACK','LG PKG') AND T2.p_size BETWEEN 1 AND 15) )
select s_name, s_address from supplier, nation where s_suppkey in (select ps_suppkey from partsupp where ps_partkey in (select p_partkey from part where p_name like 'forest%') and ps_availqty > (select 0.5 * sum(l_quantity) from lineitem where l_partkey = ps_partkey and l_suppkey = ps_suppkey and l_shipdate >= date('1994-01-01') and l_shipdate < date('1994-01-01', '+1 year'))) and s_nationkey = n_nationkey and n_name = 'CANADA' order by s_name
SELECT supplier.* FROM supplier JOIN partsupp ON supplier.s_suppkey = partsupp.ps_suppkey JOIN part ON partsupp.ps_partkey = part.p_partkey WHERE part.p_name LIKE 'forest%' AND partsupp.ps_availqty > (0.5 * (SELECT SUM(p2.p_availqty) FROM partsupp AS ps2 JOIN part AS p2 ON ps2.ps_partkey = p2.p_partkey WHERE p2.p_name LIKE 'forest%' AND ps2.ps_suppkey = supplier.s_suppkey AND ps2.ps_supplycost = partsupp.ps_supplycost AND ps2.ps_availqty > 0         AND ps2.ps_supplycost > 0 AND ps2.ps_supplycost < (0.5 * (SELECT AVG(ps3.ps_supplycost) FROM partsupp AS ps3 JOIN part AS p3 ON ps3.ps_partkey = p3.p_partkey WHERE p3.p_name LIKE 'forest%' AND ps3.ps_suppkey = supplier.s_suppkey AND ps3.ps_availqty > 0 AND ps3.ps_supplycost > 0 AND ps3.ps_supplycost < (0.5 * (SELECT AVG(ps4.ps_supplycost) FROM partsupp AS ps4 JOIN part AS p4 ON ps4.ps_partkey = p4.p_partkey WHERE p4.p_name LIKE 'forest%' AND ps4.ps_suppkey = supplier.s_suppkey AND ps4.ps_availqty > 0 AND ps4.ps_supplycost > 0)))))) AND partsupp.ps_supplycost > 0 AND partsupp.ps_supplycost < (0.5 * (SELECT AVG(ps5.ps_supplycost) FROM partsupp AS ps5 JOIN part AS p5 ON ps5.ps_partkey = p5.p_partkey WHERE p5.p_name LIKE 'forest%' AND ps5.ps_suppkey = supplier.s_suppkey AND ps5.ps_availqty > 0 AND ps5.ps_supplycost > 0) )
select s_name, count(*) as numwait from supplier, lineitem l1, orders, nation where s_suppkey = l1.l_suppkey and o_orderkey = l1.l_orderkey and o_orderstatus = 'F' and l1.l_receiptdate > l1.l_commitdate and exists (select * from lineitem l2 where l2.l_orderkey = l1.l_orderkey and l2.l_suppkey <> l1.l_suppkey) and not exists (select * from lineitem l3 where l3.l_orderkey = l1.l_orderkey and l3.l_suppkey <> l1.l_suppkey and l3.l_receiptdate > l3.l_commitdate) and s_nationkey = n_nationkey and n_name = 'SAUDI ARABIA' group by s_name order by numwait desc, s_name limit 100
SELECT supplier.s_name, COUNT(DISTINCT lineitem.l_orderkey) AS num_waits  FROM supplier  JOIN partsupp ON supplier.s_suppkey = partsupp.ps_suppkey  JOIN lineitem ON partsupp.ps_partkey = lineitem.l_partkey AND partsupp.ps_suppkey = lineitem.l_suppkey  JOIN orders ON lineitem.l_orderkey = orders.o_orderkey  JOIN customer ON orders.o_custkey = customer.c_custkey  JOIN nation ON customer.c_nationkey = nation.n_nationkey  WHERE nation.n_name = 'SAUDI ARABIA'  AND orders.o_orderstatus = 'F'  AND lineitem.l_receiptdate > lineitem.l_commitdate  GROUP BY supplier.s_name  ORDER BY num_waits DESC, supplier.s_name ASC  LIMIT 100
select cntrycode, count(*) as numcust, sum(c_acctbal) as totacctbal from (select substr(c_phone, 1, 2) as cntrycode, c_acctbal from customer where substr(c_phone, 1, 2) in ('13', '31','23','29','30','18','17') and c_acctbal > (select avg(c_acctbal) from customer where c_acctbal > 0.00 and substr(c_phone, 1, 2) in ('13', '31','23','29','30','18','17')) and not exists (select * from orders where o_custkey = c_custkey)) as custsale group by cntrycode order by cntrycode
SELECT count(*), left(c_phone,2)  FROM customer  WHERE (left(c_phone,2) IN ('13', '31', '23', '29', '30', '18', '17'))  AND c_acctbal > (SELECT avg(c_acctbal) FROM customer)  AND c_custkey NOT IN (SELECT o_custkey FROM orders)  GROUP BY left(c_phone,2)  ORDER BY left(c_phone,2) ASC